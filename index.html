<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Starbucks Drinks</title>
	<link rel="stylesheet" href="styles.css">
	<!-- D3.js -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
</head>
<body>
	<header>Starbucks Drinks</header>
	<h1>Comparing Nutritional Values in Starbucks Drinks</h1>
	<div style="display: block;">
		<div id="scatterplot" style="display: inline-flex;">
			<svg width="700" height="700" style="border: 1px solid #777;" id="chart1">
			</svg>
			<form style="display: block;">
				X-Axis <select id="xaxis" name="xaxis">
				</select>	
			</br>
				Y-Axis <select id="yaxis" name="yaxis">
				</select>
			</br>
				<div id="table">
					<table>
						<tr>
							<th id="Beverage">Beverage</th>
							<th id="Category">Category</th>
							<th id="Prep">Prep</th>
							<th id="XAxesData"></th>
							<th id="YAxesData"></th>
						</tr>
					</table>
				</div>		  
			</form>
		</div>

		<h1>Radar Plot</h1>
		<div class="radarChart" style="display: inline-flex;">
			<!-- <svg width="700" height="700" style="border: 1px solid #777;"> -->
			</svg>
			<form style="display: block;">
				Drink 1 <select id="drink1" name="drink1">
				</select>	
			</br>
				Drink 2 <select id="drink2" name="drink2">
				</select>	
			</br>
				Drink 3 <select id="drink3" name="drink3">
				</select>
			</br>
				Drink 4 <select id="drink4" name="drink4">
				</select>		  
			</form>
		</div>
	</div>


	<!-- <div class="radarChart"></div> -->
	<script src="./js/radarplot.js"></script>	
		<script>
      
      /* Radar chart design created by Nadieh Bremer - VisualCinnamon.com */
      
			////////////////////////////////////////////////////////////// 
			//////////////////////// Set-Up ////////////////////////////// 
			////////////////////////////////////////////////////////////// 

			var margin = {top: 50, right: 100, bottom: 100, left: 100},
				width = Math.min(700, window.innerWidth - 10) - margin.left - margin.right,
				height = Math.min(width, window.innerHeight - margin.top - margin.bottom - 20);
			
			console.log(width);
			console.log(height);
			////////////////////////////////////////////////////////////// 
			////////////////////////// Data ////////////////////////////// 
			////////////////////////////////////////////////////////////// 

			var counter = 0;	
			var data = [];
			var displayDataIndices = [];
			var displayData = [];
			var categories = [' Total Fat (g)', ' Protein (g) ', 'Caffeine (mg)', 'Calories', ' Total Carbohydrates (g) ']
			// ' Total Carbohydrates (g) '

			// Hey Joseph, currently I'm parsing all the csv rows as the desired format. I think after you finish your part, we should be able to pass in just an array of drinks that are needed to be displayed and parse them. 
			// So the dropdown should have a mechanism of parsing the drink name that the user selects into the index, which we then use to extract the actual rows themselves into data processing? Let me know when if what I said does not make sense. 

			// TODO: Is there a way to do different scale for each axis?
			d3.csv('starbucksdrinks.csv', function(csvData) {	
				csvData.forEach(
					function(d) {
						// console.log("d.bev_prep");
						// console.log(d.Beverage_prep);
						if (d.Beverage_prep == "Venti" || d.Beverage_prep == "Venti Nonfat Milk") {	

							d.Calories = +d.Calories;
							d['Caffeine (mg)'] = +d['Caffeine (mg)'];
							d[' Sugars (g)'] = +d[' Sugars (g)'];
							d[' Total Fat (g)'] = +d[' Total Fat (g)'];
							d[' Protein (g) '] = +d[' Protein (g) '];
							d['Calories'] = +d['Calories'];
							d[' Total Carbohydrates (g) '] = +d[' Total Carbohydrates (g) '];

							var one_data = []

							for (var i = 0; i < categories.length; i++) {
								var p = {group: d['Beverage'], axis: categories[i].trim(), value: d[categories[i]]};
								one_data.push(p);
							}
						data.push(one_data);

						// Format the text to indicate frappuccinos
						var text = "";
						if (d['Beverage_category'] == "Frappuccino Blended Coffee" || d['Beverage_category'] == "Frappuccino Blended Creme") {
							text = "Frappuccino: " + d['Beverage'];
						} else if (d['Beverage_category'] == "Frappuccino Light Blended Coffee") {
							text = "Light Frappuccino: " + d['Beverage'];
						} else {
							text = d['Beverage'];
						}

						// grab the dropdown selectors
						var drink1select = d3.select("#drink1");
						var drink2select = d3.select("#drink2");
						var drink3select = d3.select("#drink3");
						var drink4select = d3.select("#drink4")

						//adds each element to the dropdown, and chooses the first 4 to be selected by default
						if (counter == 0) {
							drink1select.append("option").text(text).property("value", counter).property("selected", "selected");
						} else {
							drink1select.append("option").text(text).property("value", counter);
						}
						if (counter == 1) {
							drink2select.append("option").text(text).property("value", counter).property("selected", "selected");
						} else {
							drink2select.append("option").text(text).property("value", counter);
						}
						if (counter == 2) {
							drink3select.append("option").text(text).property("value", counter).property("selected", "selected");
						} else {
							drink3select.append("option").text(text).property("value", counter);
						}
						if (counter == 3) {
							drink4select.append("option").text(text).property("value", counter).property("selected", "selected");
						} else {
							drink4select.append("option").text(text).property("value", counter);
						}

						// increments the counter after each element that fits the requirements 
						counter += 1;
						}

						// counter += 1;
					}
				);

				////////////////////////////////////////////////////////////// 
				//////////////////// Draw the Chart ////////////////////////// 
				////////////////////////////////////////////////////////////// 

				var color = d3.scale.ordinal()
					.range(["#EDC951","#CC333F","#00A0B0", "343942"]);
					
				var radarChartOptions = {
				w: width,
				h: height,
				margin: margin,
				maxValue: "1",
				axesFields: ["Total Fat (g)", "Protein (g)", "Caffeine (mg)", "Calories", "Total Carbohydrates (g)"],
				levels: 5,
				roundStrokes: true,
				color: color,
				paddingX: 80,
				legendBoxSize: 10,
				};
				
				//shows the correct, 29 element array after parsing
				console.log("Data array after parsing:");
				console.log(data);

				// grab selected values from dropdown menus
				// add values (indices) to displayDataIndices array
				// for each index in displayDataIndices, grab the item in data and add to displayData array
				// call the radarchart function with the displayData array


				//Call function to draw the Radar chart
				RadarChart(".radarChart", data.slice(0, 4), radarChartOptions);
			});
			
		</script>
</body>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="./js/scatterplot.js"></script>
<script src="./js/radarplot.js"></script>

</br>
<hr />
<footer>
	Â© Joseph Meredith, Kimberly Do, Sabrina Chua, Yujia Gao
</footer>
</html>
